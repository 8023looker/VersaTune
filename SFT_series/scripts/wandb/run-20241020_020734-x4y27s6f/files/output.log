
  0%|                                                  | 0/3900 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/cpfs/29f69eb5e2e60f26/user/sft_intern/anaconda3/envs/keerlu_sft/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/cpfs/29f69eb5e2e60f26/user/sft_intern/anaconda3/envs/keerlu_sft/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  0%|                                       | 1/3900 [00:23<25:01:02, 23.10s/it]

  0%|                                       | 2/3900 [00:41<21:51:11, 20.18s/it]

  0%|                                       | 3/3900 [00:58<20:35:32, 19.02s/it]

  0%|                                       | 4/3900 [01:16<19:52:49, 18.37s/it]

  0%|                                       | 5/3900 [01:34<19:40:36, 18.19s/it]

  0%|                                       | 6/3900 [01:52<19:37:19, 18.14s/it]

  0%|                                       | 7/3900 [02:09<19:20:55, 17.89s/it]

  0%|                                       | 8/3900 [02:28<19:33:28, 18.09s/it]

  0%|                                       | 9/3900 [02:46<19:39:02, 18.18s/it]

  0%|                                      | 10/3900 [03:04<19:32:04, 18.08s/it]

  0%|                                      | 11/3900 [03:22<19:31:11, 18.07s/it]

  0%|                                      | 12/3900 [03:40<19:31:04, 18.07s/it]

  0%|▏                                     | 13/3900 [03:59<19:51:17, 18.39s/it]

  0%|▏                                     | 14/3900 [04:17<19:46:05, 18.31s/it]

  0%|▏                                     | 15/3900 [04:35<19:38:06, 18.19s/it]

  0%|▏                                     | 16/3900 [04:53<19:31:29, 18.10s/it]

  0%|▏                                     | 17/3900 [05:11<19:24:44, 18.00s/it]

  0%|▏                                     | 18/3900 [05:29<19:34:27, 18.15s/it]

  0%|▏                                     | 19/3900 [05:47<19:28:39, 18.07s/it]

  1%|▏                                     | 20/3900 [06:05<19:25:37, 18.03s/it]

  1%|▏                                     | 21/3900 [06:24<19:31:42, 18.12s/it]

  1%|▏                                     | 22/3900 [06:41<19:24:46, 18.02s/it]

  1%|▏                                     | 23/3900 [06:59<19:26:12, 18.05s/it]

  1%|▏                                     | 24/3900 [07:18<19:38:42, 18.25s/it]

  1%|▏                                     | 25/3900 [07:36<19:26:01, 18.05s/it]

  1%|▎                                     | 26/3900 [07:55<19:43:42, 18.33s/it]

  1%|▎                                     | 27/3900 [08:13<19:41:45, 18.31s/it]

  1%|▎                                     | 28/3900 [08:30<19:21:46, 18.00s/it]

  1%|▎                                     | 29/3900 [08:48<19:22:27, 18.02s/it]

  1%|▎                                     | 30/3900 [09:07<19:33:09, 18.19s/it]

  1%|▎                                     | 31/3900 [09:24<19:17:36, 17.95s/it]

  1%|▎                                     | 32/3900 [09:43<19:21:55, 18.02s/it]

  1%|▎                                     | 33/3900 [10:00<19:13:09, 17.89s/it]

  1%|▎                                     | 34/3900 [10:18<19:21:18, 18.02s/it]

  1%|▎                                     | 35/3900 [10:36<19:18:20, 17.98s/it]

  1%|▎                                     | 36/3900 [10:54<19:14:28, 17.93s/it]

  1%|▎                                     | 37/3900 [11:13<19:34:23, 18.24s/it]

  1%|▎                                     | 38/3900 [11:31<19:20:14, 18.03s/it]

  1%|▍                                     | 39/3900 [11:48<19:16:00, 17.96s/it]

  1%|▍                                     | 40/3900 [12:07<19:17:08, 17.99s/it]

  1%|▍                                     | 41/3900 [12:25<19:23:57, 18.10s/it]

  1%|▍                                     | 42/3900 [12:43<19:20:18, 18.05s/it]

  1%|▍                                     | 43/3900 [13:01<19:22:45, 18.09s/it]

  1%|▍                                     | 44/3900 [13:19<19:23:16, 18.10s/it]

  1%|▍                                     | 45/3900 [13:38<19:38:29, 18.34s/it]

  1%|▍                                     | 46/3900 [13:55<19:21:35, 18.08s/it]

  1%|▍                                     | 47/3900 [14:13<19:16:03, 18.00s/it]

  1%|▍                                     | 48/3900 [14:31<19:17:42, 18.03s/it]

  1%|▍                                     | 49/3900 [14:49<19:17:46, 18.04s/it]

  1%|▍                                     | 50/3900 [15:07<19:19:19, 18.07s/it]


  1%|▍                                     | 51/3900 [15:26<19:23:18, 18.13s/it]

  1%|▌                                     | 52/3900 [15:44<19:24:07, 18.15s/it]

  1%|▌                                     | 53/3900 [16:02<19:22:52, 18.14s/it]

  1%|▌                                     | 54/3900 [16:21<19:33:45, 18.31s/it]

  1%|▌                                     | 55/3900 [16:39<19:25:49, 18.19s/it]

  1%|▌                                     | 56/3900 [16:57<19:24:11, 18.17s/it]

  1%|▌                                     | 57/3900 [17:15<19:18:29, 18.09s/it]

  1%|▌                                     | 58/3900 [17:33<19:20:57, 18.13s/it]

  2%|▌                                     | 59/3900 [17:51<19:20:08, 18.12s/it]

  2%|▌                                     | 60/3900 [18:10<19:32:32, 18.32s/it]

  2%|▌                                     | 61/3900 [18:28<19:31:28, 18.31s/it]

  2%|▌                                     | 62/3900 [18:46<19:27:16, 18.25s/it]

  2%|▌                                     | 63/3900 [19:05<19:29:39, 18.29s/it]

  2%|▌                                     | 64/3900 [19:21<18:52:23, 17.71s/it]

  2%|▋                                     | 65/3900 [19:37<18:25:12, 17.29s/it]

  2%|▋                                     | 66/3900 [19:53<17:59:02, 16.89s/it]

  2%|▋                                     | 67/3900 [20:10<17:47:07, 16.70s/it]

  2%|▋                                     | 68/3900 [20:26<17:36:46, 16.55s/it]

  2%|▋                                     | 69/3900 [20:42<17:25:18, 16.37s/it]

  2%|▋                                     | 70/3900 [20:58<17:29:33, 16.44s/it]

  2%|▋                                     | 71/3900 [21:14<17:24:03, 16.36s/it]

  2%|▋                                     | 72/3900 [21:31<17:20:23, 16.31s/it]

  2%|▋                                     | 73/3900 [21:47<17:12:03, 16.18s/it]

  2%|▋                                     | 74/3900 [22:03<17:09:04, 16.14s/it]

  2%|▋                                     | 75/3900 [22:19<17:22:54, 16.36s/it]

  2%|▋                                     | 76/3900 [22:35<17:06:34, 16.11s/it]

  2%|▊                                     | 77/3900 [22:52<17:13:17, 16.22s/it]

  2%|▊                                     | 78/3900 [23:07<16:59:10, 16.00s/it]

  2%|▊                                     | 79/3900 [23:24<17:11:27, 16.20s/it]

  2%|▊                                     | 80/3900 [23:40<17:08:00, 16.15s/it]

  2%|▊                                     | 81/3900 [23:55<17:00:09, 16.03s/it]

  2%|▊                                     | 82/3900 [24:11<16:50:09, 15.87s/it]

  2%|▊                                     | 83/3900 [24:27<17:00:47, 16.05s/it]

  2%|▊                                     | 84/3900 [24:43<16:59:50, 16.04s/it]

  2%|▊                                     | 85/3900 [25:00<17:06:40, 16.15s/it]

  2%|▊                                     | 86/3900 [25:16<17:09:48, 16.20s/it]

  2%|▊                                     | 87/3900 [25:33<17:16:12, 16.31s/it]

  2%|▊                                     | 88/3900 [25:49<17:12:31, 16.25s/it]

  2%|▊                                     | 89/3900 [26:05<17:06:24, 16.16s/it]

  2%|▉                                     | 90/3900 [26:20<16:57:56, 16.03s/it]

  2%|▉                                     | 91/3900 [26:36<16:56:44, 16.02s/it]

  2%|▉                                     | 92/3900 [26:52<16:45:49, 15.85s/it]

  2%|▉                                     | 93/3900 [27:08<16:42:57, 15.81s/it]

  2%|▉                                     | 94/3900 [27:24<16:47:42, 15.89s/it]

  2%|▉                                     | 95/3900 [27:40<16:54:17, 15.99s/it]

  2%|▉                                     | 96/3900 [27:55<16:44:07, 15.84s/it]

  2%|▉                                     | 97/3900 [28:12<16:51:55, 15.97s/it]

  3%|▉                                     | 98/3900 [28:28<17:06:45, 16.20s/it]

  3%|▉                                     | 99/3900 [28:44<17:03:58, 16.16s/it]

  3%|▉                                    | 100/3900 [29:01<17:07:08, 16.22s/it]

  3%|▉                                    | 101/3900 [29:18<17:25:05, 16.51s/it]

  3%|▉                                    | 102/3900 [29:34<17:18:26, 16.41s/it]

  3%|▉                                    | 103/3900 [29:50<17:08:11, 16.25s/it]

  3%|▉                                    | 104/3900 [30:06<17:03:53, 16.18s/it]

  3%|▉                                    | 105/3900 [30:22<17:02:50, 16.17s/it]

  3%|█                                    | 106/3900 [30:39<17:08:38, 16.27s/it]

  3%|█                                    | 107/3900 [30:54<16:54:35, 16.05s/it]

  3%|█                                    | 108/3900 [31:10<16:58:48, 16.12s/it]


  3%|█                                    | 109/3900 [31:27<17:03:13, 16.19s/it]

  3%|█                                    | 110/3900 [31:42<16:50:54, 16.00s/it]

  3%|█                                    | 111/3900 [31:59<16:52:14, 16.03s/it]

  3%|█                                    | 112/3900 [32:15<16:57:41, 16.12s/it]

  3%|█                                    | 113/3900 [32:31<16:59:06, 16.15s/it]

  3%|█                                    | 114/3900 [32:47<16:56:14, 16.11s/it]

  3%|█                                    | 115/3900 [33:04<17:05:24, 16.25s/it]

  3%|█                                    | 116/3900 [33:20<16:57:25, 16.13s/it]

  3%|█                                    | 117/3900 [33:35<16:50:18, 16.02s/it]

  3%|█                                    | 118/3900 [33:51<16:42:04, 15.90s/it]

  3%|█▏                                   | 119/3900 [34:07<16:47:29, 15.99s/it]

  3%|█▏                                   | 120/3900 [34:23<16:48:36, 16.01s/it]

  3%|█▏                                   | 121/3900 [34:40<16:59:03, 16.18s/it]

  3%|█▏                                   | 122/3900 [34:55<16:48:51, 16.02s/it]

  3%|█▏                                   | 123/3900 [35:11<16:45:59, 15.98s/it]

  3%|█▏                                   | 124/3900 [35:28<16:49:52, 16.05s/it]

  3%|█▏                                   | 125/3900 [35:44<16:49:31, 16.05s/it]

  3%|█▏                                   | 126/3900 [36:00<16:56:22, 16.16s/it]

  3%|█▏                                   | 127/3900 [36:16<16:57:39, 16.18s/it]

  3%|█▏                                   | 128/3900 [36:32<16:57:52, 16.19s/it]

  3%|█▏                                   | 129/3900 [36:49<16:53:41, 16.13s/it]

  3%|█▏                                   | 130/3900 [37:05<16:54:15, 16.14s/it]

  3%|█▏                                   | 131/3900 [37:21<16:48:35, 16.06s/it]

  3%|█▎                                   | 132/3900 [37:36<16:45:38, 16.01s/it]

  3%|█▎                                   | 133/3900 [37:53<16:55:09, 16.17s/it]

  3%|█▎                                   | 134/3900 [38:09<16:59:25, 16.24s/it]

  3%|█▎                                   | 135/3900 [38:25<16:54:52, 16.17s/it]

  3%|█▎                                   | 136/3900 [38:41<16:46:51, 16.05s/it]

  4%|█▎                                   | 137/3900 [38:58<16:51:55, 16.13s/it]

  4%|█▎                                   | 138/3900 [39:14<16:55:54, 16.20s/it]

  4%|█▎                                   | 139/3900 [39:30<16:50:56, 16.13s/it]

  4%|█▎                                   | 140/3900 [39:46<16:51:24, 16.14s/it]

  4%|█▎                                   | 141/3900 [40:02<16:50:01, 16.12s/it]

  4%|█▎                                   | 142/3900 [40:18<16:44:32, 16.04s/it]

  4%|█▎                                   | 143/3900 [40:34<16:46:03, 16.07s/it]

  4%|█▎                                   | 144/3900 [40:50<16:47:00, 16.09s/it]

  4%|█▍                                   | 145/3900 [41:06<16:45:19, 16.06s/it]

  4%|█▍                                   | 146/3900 [41:22<16:49:22, 16.13s/it]

  4%|█▍                                   | 147/3900 [41:38<16:46:41, 16.09s/it]

  4%|█▍                                   | 148/3900 [41:55<16:49:19, 16.14s/it]

  4%|█▍                                   | 149/3900 [42:11<16:53:23, 16.21s/it]

  4%|█▍                                   | 150/3900 [42:27<16:48:40, 16.14s/it]

  4%|█▍                                   | 151/3900 [42:43<16:51:04, 16.18s/it]

  4%|█▍                                   | 152/3900 [42:59<16:44:32, 16.08s/it]

  4%|█▍                                   | 153/3900 [43:15<16:45:48, 16.11s/it]

  4%|█▍                                   | 154/3900 [43:31<16:42:38, 16.06s/it]

  4%|█▍                                   | 155/3900 [43:47<16:44:00, 16.09s/it]

  4%|█▍                                   | 156/3900 [44:03<16:36:27, 15.97s/it]

  4%|█▍                                   | 157/3900 [44:20<16:48:48, 16.17s/it]

  4%|█▍                                   | 158/3900 [44:36<16:50:32, 16.20s/it]

  4%|█▌                                   | 159/3900 [44:52<16:45:16, 16.12s/it]

  4%|█▌                                   | 160/3900 [45:08<16:46:42, 16.15s/it]

  4%|█▌                                   | 161/3900 [45:24<16:38:01, 16.02s/it]

  4%|█▌                                   | 162/3900 [45:39<16:25:19, 15.82s/it]

  4%|█▌                                   | 163/3900 [45:55<16:21:03, 15.75s/it]

  4%|█▌                                   | 164/3900 [46:11<16:33:26, 15.95s/it]

  4%|█▌                                   | 165/3900 [46:27<16:29:41, 15.90s/it]

  4%|█▌                                   | 166/3900 [46:43<16:37:15, 16.02s/it]


  4%|█▌                                   | 167/3900 [47:00<16:40:29, 16.08s/it]

  4%|█▌                                   | 168/3900 [47:16<16:43:36, 16.14s/it]

  4%|█▌                                   | 169/3900 [47:31<16:29:01, 15.91s/it]

  4%|█▌                                   | 170/3900 [47:47<16:30:02, 15.93s/it]

  4%|█▌                                   | 171/3900 [48:03<16:32:55, 15.98s/it]

  4%|█▋                                   | 172/3900 [48:19<16:32:41, 15.98s/it]

  4%|█▋                                   | 173/3900 [48:35<16:34:22, 16.01s/it]

  4%|█▋                                   | 174/3900 [48:51<16:36:18, 16.04s/it]

  4%|█▋                                   | 175/3900 [49:07<16:32:57, 15.99s/it]

  5%|█▋                                   | 176/3900 [49:24<16:44:23, 16.18s/it]

  5%|█▋                                   | 177/3900 [49:40<16:44:19, 16.19s/it]

  5%|█▋                                   | 178/3900 [49:56<16:33:32, 16.02s/it]

  5%|█▋                                   | 179/3900 [50:12<16:39:53, 16.12s/it]

  5%|█▋                                   | 180/3900 [50:28<16:28:13, 15.94s/it]

  5%|█▋                                   | 181/3900 [50:44<16:25:58, 15.91s/it]

  5%|█▋                                   | 182/3900 [50:59<16:26:12, 15.92s/it]

  5%|█▋                                   | 183/3900 [51:16<16:34:00, 16.05s/it]

  5%|█▋                                   | 184/3900 [51:32<16:41:44, 16.17s/it]

  5%|█▊                                   | 185/3900 [51:48<16:30:20, 15.99s/it]

  5%|█▊                                   | 186/3900 [52:04<16:38:58, 16.14s/it]

  5%|█▊                                   | 187/3900 [52:20<16:39:38, 16.15s/it]

  5%|█▊                                   | 188/3900 [52:37<16:44:21, 16.23s/it]

  5%|█▊                                   | 189/3900 [52:53<16:43:47, 16.23s/it]

  5%|█▊                                   | 190/3900 [53:09<16:39:19, 16.16s/it]

  5%|█▊                                   | 191/3900 [53:26<16:45:01, 16.26s/it]

  5%|█▊                                   | 192/3900 [53:41<16:31:35, 16.05s/it]

  5%|█▊                                   | 193/3900 [53:57<16:36:36, 16.13s/it]

  5%|█▊                                   | 194/3900 [54:14<16:39:51, 16.19s/it]

  5%|█▊                                   | 195/3900 [54:30<16:36:23, 16.14s/it]

  5%|█▊                                   | 196/3900 [54:46<16:45:48, 16.29s/it]

  5%|█▊                                   | 197/3900 [55:03<16:46:13, 16.30s/it]

  5%|█▉                                   | 198/3900 [55:19<16:45:06, 16.29s/it]

  5%|█▉                                   | 199/3900 [55:35<16:35:55, 16.15s/it]

  5%|█▉                                   | 200/3900 [55:51<16:36:41, 16.16s/it]

  5%|█▉                                   | 201/3900 [56:07<16:37:41, 16.18s/it]

  5%|█▉                                   | 202/3900 [56:23<16:27:42, 16.03s/it]

  5%|█▉                                   | 203/3900 [56:39<16:30:58, 16.08s/it]

  5%|█▉                                   | 204/3900 [56:55<16:33:47, 16.13s/it]

  5%|█▉                                   | 205/3900 [57:12<16:36:37, 16.18s/it]

  5%|█▉                                   | 206/3900 [57:27<16:24:11, 15.99s/it]

  5%|█▉                                   | 207/3900 [57:44<16:30:40, 16.10s/it]

  5%|█▉                                   | 208/3900 [58:00<16:26:56, 16.04s/it]

  5%|█▉                                   | 209/3900 [58:15<16:13:26, 15.82s/it]

  5%|█▉                                   | 210/3900 [58:30<16:07:36, 15.73s/it]

  5%|██                                   | 211/3900 [58:46<16:09:25, 15.77s/it]

  5%|██                                   | 212/3900 [59:02<16:09:08, 15.77s/it]

  5%|██                                   | 213/3900 [59:18<16:18:38, 15.93s/it]

  5%|██                                   | 214/3900 [59:35<16:28:28, 16.09s/it]

  6%|██                                   | 215/3900 [59:51<16:36:45, 16.23s/it]

  6%|█▉                                 | 216/3900 [1:00:07<16:20:11, 15.96s/it]

  6%|█▉                                 | 217/3900 [1:00:23<16:28:02, 16.10s/it]

  6%|█▉                                 | 218/3900 [1:00:39<16:20:10, 15.97s/it]

  6%|█▉                                 | 219/3900 [1:00:54<16:09:39, 15.81s/it]

  6%|█▉                                 | 220/3900 [1:01:10<16:09:07, 15.80s/it]

  6%|█▉                                 | 221/3900 [1:01:26<16:11:10, 15.84s/it]

  6%|█▉                                 | 222/3900 [1:01:42<16:21:43, 16.02s/it]

  6%|██                                 | 223/3900 [1:01:58<16:11:56, 15.86s/it]

  6%|██                                 | 224/3900 [1:02:14<16:14:12, 15.90s/it]

  6%|██                                 | 225/3900 [1:02:30<16:15:51, 15.93s/it]

  6%|██                                 | 226/3900 [1:02:46<16:14:54, 15.92s/it]

  6%|██                                 | 227/3900 [1:03:02<16:12:38, 15.89s/it]

  6%|██                                 | 228/3900 [1:03:18<16:22:56, 16.06s/it]

  6%|██                                 | 229/3900 [1:03:34<16:19:42, 16.01s/it]

  6%|██                                 | 230/3900 [1:03:50<16:27:47, 16.15s/it]

  6%|██                                 | 231/3900 [1:04:06<16:14:52, 15.94s/it]

  6%|██                                 | 232/3900 [1:04:22<16:19:17, 16.02s/it]

  6%|██                                 | 233/3900 [1:04:39<16:35:22, 16.29s/it]

  6%|██                                 | 234/3900 [1:04:55<16:27:52, 16.17s/it]

  6%|██                                 | 235/3900 [1:05:11<16:33:36, 16.27s/it]

  6%|██                                 | 236/3900 [1:05:28<16:33:30, 16.27s/it]

  6%|██▏                                | 237/3900 [1:05:43<16:26:15, 16.15s/it]

  6%|██▏                                | 238/3900 [1:05:59<16:23:37, 16.12s/it]

  6%|██▏                                | 239/3900 [1:06:15<16:18:15, 16.03s/it]

  6%|██▏                                | 240/3900 [1:06:31<16:20:39, 16.08s/it]

  6%|██▏                                | 241/3900 [1:06:47<16:16:08, 16.01s/it]

  6%|██▏                                | 242/3900 [1:07:03<16:13:39, 15.97s/it]

  6%|██▏                                | 243/3900 [1:07:19<16:08:56, 15.90s/it]

  6%|██▏                                | 244/3900 [1:07:35<16:11:07, 15.94s/it]

  6%|██▏                                | 245/3900 [1:07:51<16:18:51, 16.07s/it]

  6%|██▏                                | 246/3900 [1:08:08<16:22:07, 16.13s/it]

  6%|██▏                                | 247/3900 [1:08:23<16:12:31, 15.97s/it]

  6%|██▏                                | 248/3900 [1:08:39<16:17:16, 16.06s/it]

  6%|██▏                                | 249/3900 [1:08:56<16:19:55, 16.10s/it]

  6%|██▏                                | 250/3900 [1:09:12<16:28:21, 16.25s/it]

  6%|██▎                                | 251/3900 [1:09:28<16:24:23, 16.19s/it]

  6%|██▎                                | 252/3900 [1:09:43<15:59:43, 15.78s/it]

  6%|██▎                                | 253/3900 [1:09:58<15:44:07, 15.53s/it]

  7%|██▎                                | 254/3900 [1:10:12<15:21:42, 15.17s/it]

  7%|██▎                                | 255/3900 [1:10:26<15:02:16, 14.85s/it]

  7%|██▎                                | 256/3900 [1:10:41<14:52:59, 14.70s/it]
