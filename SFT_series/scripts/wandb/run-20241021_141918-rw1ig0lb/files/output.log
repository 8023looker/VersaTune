  0%|                                                                                                                                                                                                              | 0/3900 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/cpfs/29f69eb5e2e60f26/user/sft_intern/anaconda3/envs/keerlu_sft/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:600: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/cpfs/29f69eb5e2e60f26/user/sft_intern/anaconda3/envs/keerlu_sft/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  0%|                                                                                                                                                                                                   | 1/3900 [00:09<10:00:18,  9.24s/it]

  0%|                                                                                                                                                                                                    | 2/3900 [00:15<8:22:15,  7.73s/it]
{'loss': 1.2107, 'grad_norm': 8.65027141571045, 'learning_rate': 3.4188034188034194e-07, 'epoch': 0.05}

  0%|▏                                                                                                                                                                                                   | 3/3900 [00:22<7:43:39,  7.14s/it]

  0%|▏                                                                                                                                                                                                   | 4/3900 [00:28<7:28:10,  6.90s/it]


  0%|▎                                                                                                                                                                                                   | 6/3900 [00:41<7:10:07,  6.63s/it]
{'loss': 1.154, 'grad_norm': 6.256436347961426, 'learning_rate': 1.0256410256410257e-06, 'epoch': 0.15}

  0%|▎                                                                                                                                                                                                   | 7/3900 [00:48<7:07:01,  6.58s/it]

  0%|▍                                                                                                                                                                                                   | 8/3900 [00:54<7:07:05,  6.58s/it]


  0%|▌                                                                                                                                                                                                  | 10/3900 [01:07<7:03:05,  6.53s/it]
{'loss': 0.956, 'grad_norm': 3.836338996887207, 'learning_rate': 1.7094017094017097e-06, 'epoch': 0.26}

  0%|▌                                                                                                                                                                                                  | 11/3900 [01:14<7:02:43,  6.52s/it]

  0%|▌                                                                                                                                                                                                  | 12/3900 [01:20<6:58:29,  6.46s/it]


  0%|▋                                                                                                                                                                                                  | 14/3900 [01:33<6:55:53,  6.42s/it]

  0%|▊                                                                                                                                                                                                  | 15/3900 [01:40<6:58:35,  6.46s/it]
{'loss': 0.8288, 'grad_norm': 1.8177727460861206, 'learning_rate': 2.564102564102564e-06, 'epoch': 0.38}

  0%|▊                                                                                                                                                                                                  | 16/3900 [01:46<6:59:01,  6.47s/it]


  0%|▉                                                                                                                                                                                                  | 18/3900 [01:59<6:59:14,  6.48s/it]

  0%|▉                                                                                                                                                                                                  | 19/3900 [02:05<6:57:46,  6.46s/it]

  1%|█                                                                                                                                                                                                  | 20/3900 [02:12<6:56:25,  6.44s/it]
{'loss': 0.7961, 'grad_norm': 1.3454252481460571, 'learning_rate': 3.4188034188034193e-06, 'epoch': 0.51}

  1%|█                                                                                                                                                                                                  | 21/3900 [02:18<6:54:02,  6.40s/it]


  1%|█▏                                                                                                                                                                                                 | 23/3900 [02:31<6:57:25,  6.46s/it]

  1%|█▏                                                                                                                                                                                                 | 24/3900 [02:38<6:58:41,  6.48s/it]
{'loss': 0.7939, 'grad_norm': 1.1081269979476929, 'learning_rate': 4.102564102564103e-06, 'epoch': 0.61}

  1%|█▎                                                                                                                                                                                                 | 25/3900 [02:44<7:02:22,  6.54s/it]


  1%|█▎                                                                                                                                                                                                 | 27/3900 [02:57<6:59:14,  6.49s/it]

  1%|█▍                                                                                                                                                                                                 | 28/3900 [03:04<6:56:23,  6.45s/it]
{'loss': 0.7656, 'grad_norm': 0.9860175848007202, 'learning_rate': 4.786324786324787e-06, 'epoch': 0.72}

  1%|█▍                                                                                                                                                                                                 | 29/3900 [03:10<6:54:52,  6.43s/it]


  1%|█▌                                                                                                                                                                                                 | 31/3900 [03:23<6:58:37,  6.49s/it]

  1%|█▌                                                                                                                                                                                                 | 32/3900 [03:29<6:56:08,  6.46s/it]

  1%|█▌                                                                                                                                                                                                 | 32/3900 [03:30<6:56:08,  6.46s/it]

  1%|█▋                                                                                                                                                                                                 | 33/3900 [03:36<6:56:10,  6.46s/it]

  1%|█▋                                                                                                                                                                                                 | 34/3900 [03:42<6:55:24,  6.45s/it]


  1%|█▊                                                                                                                                                                                                 | 36/3900 [03:55<6:52:17,  6.40s/it]

  1%|█▊                                                                                                                                                                                                 | 37/3900 [04:02<6:58:34,  6.50s/it]
{'loss': 0.7199, 'grad_norm': 0.9289905428886414, 'learning_rate': 6.324786324786325e-06, 'epoch': 0.95}

  1%|█▉                                                                                                                                                                                                 | 38/3900 [04:08<6:56:32,  6.47s/it]


  1%|██                                                                                                                                                                                                 | 40/3900 [04:21<6:55:45,  6.46s/it]

  1%|██                                                                                                                                                                                                 | 41/3900 [04:28<6:53:36,  6.43s/it]

  1%|██                                                                                                                                                                                                 | 42/3900 [04:34<6:54:00,  6.44s/it]
{'loss': 0.6984, 'grad_norm': 0.9492435455322266, 'learning_rate': 7.17948717948718e-06, 'epoch': 1.07}

  1%|██▏                                                                                                                                                                                                | 43/3900 [04:40<6:53:23,  6.43s/it]


  1%|██▎                                                                                                                                                                                                | 45/3900 [04:54<6:56:59,  6.49s/it]
{'loss': 0.6698, 'grad_norm': 0.8774502277374268, 'learning_rate': 7.692307692307694e-06, 'epoch': 1.15}

  1%|██▎                                                                                                                                                                                                | 46/3900 [05:00<6:52:50,  6.43s/it]

  1%|██▎                                                                                                                                                                                                | 47/3900 [05:06<6:57:06,  6.50s/it]


  1%|██▍                                                                                                                                                                                                | 49/3900 [05:19<6:56:09,  6.48s/it]

  1%|██▌                                                                                                                                                                                                | 50/3900 [05:26<6:59:11,  6.53s/it]
{'loss': 0.6781, 'grad_norm': 0.9205005168914795, 'learning_rate': 8.547008547008548e-06, 'epoch': 1.28}

  1%|██▌                                                                                                                                                                                                | 51/3900 [05:33<7:01:03,  6.56s/it]


  1%|██▋                                                                                                                                                                                                | 53/3900 [05:46<6:57:47,  6.52s/it]
{'loss': 0.6888, 'grad_norm': 0.9745376110076904, 'learning_rate': 9.059829059829061e-06, 'epoch': 1.35}

  1%|██▋                                                                                                                                                                                                | 54/3900 [05:52<7:02:29,  6.59s/it]

  1%|██▊                                                                                                                                                                                                | 55/3900 [05:59<6:57:45,  6.52s/it]

  1%|██▊                                                                                                                                                                                                | 56/3900 [06:05<6:57:12,  6.51s/it]

  1%|██▊                                                                                                                                                                                                | 57/3900 [06:12<7:05:47,  6.65s/it]


  2%|██▉                                                                                                                                                                                                | 59/3900 [06:25<7:02:41,  6.60s/it]

  2%|███                                                                                                                                                                                                | 60/3900 [06:32<6:59:06,  6.55s/it]
{'loss': 0.624, 'grad_norm': 0.8759264945983887, 'learning_rate': 1.0256410256410256e-05, 'epoch': 1.53}


  2%|███                                                                                                                                                                                                | 62/3900 [06:46<7:10:42,  6.73s/it]
{'loss': 0.6359, 'grad_norm': 0.9432468414306641, 'learning_rate': 1.05982905982906e-05, 'epoch': 1.58}


  2%|███▏                                                                                                                                                                                               | 64/3900 [07:00<7:22:41,  6.92s/it]
{'loss': 0.6195, 'grad_norm': 0.9791229963302612, 'learning_rate': 1.0940170940170942e-05, 'epoch': 1.64}


  2%|███▎                                                                                                                                                                                               | 66/3900 [07:14<7:27:44,  7.01s/it]
{'loss': 0.6417, 'grad_norm': 0.9123198986053467, 'learning_rate': 1.1282051282051283e-05, 'epoch': 1.69}


  2%|███▍                                                                                                                                                                                               | 68/3900 [07:28<7:28:26,  7.02s/it]
{'loss': 0.6722, 'grad_norm': 0.9668121933937073, 'learning_rate': 1.1623931623931625e-05, 'epoch': 1.74}

  2%|███▍                                                                                                                                                                                               | 69/3900 [07:35<7:28:58,  7.03s/it]

  2%|███▍                                                                                                                                                                                               | 70/3900 [07:42<7:33:13,  7.10s/it]


  2%|███▌                                                                                                                                                                                               | 72/3900 [07:56<7:27:44,  7.02s/it]
{'loss': 0.6278, 'grad_norm': 0.9265245199203491, 'learning_rate': 1.230769230769231e-05, 'epoch': 1.84}

  2%|███▋                                                                                                                                                                                               | 73/3900 [08:03<7:28:48,  7.04s/it]


  2%|███▊                                                                                                                                                                                               | 75/3900 [08:18<7:35:50,  7.15s/it]
{'loss': 0.5835, 'grad_norm': 0.998936116695404, 'learning_rate': 1.2820512820512823e-05, 'epoch': 1.92}


  2%|███▊                                                                                                                                                                                               | 77/3900 [08:32<7:37:30,  7.18s/it]
{'loss': 0.6133, 'grad_norm': 0.950535774230957, 'learning_rate': 1.3162393162393164e-05, 'epoch': 1.97}


  2%|███▉                                                                                                                                                                                               | 79/3900 [08:46<7:32:10,  7.10s/it]
{'loss': 0.5626, 'grad_norm': 0.9633458852767944, 'learning_rate': 1.3504273504273506e-05, 'epoch': 2.02}


  2%|████                                                                                                                                                                                               | 81/3900 [09:00<7:31:58,  7.10s/it]
{'loss': 0.5686, 'grad_norm': 0.9323477149009705, 'learning_rate': 1.3846153846153847e-05, 'epoch': 2.07}


  2%|████▏                                                                                                                                                                                              | 83/3900 [09:14<7:31:19,  7.09s/it]

  2%|████▏                                                                                                                                                                                              | 84/3900 [09:22<7:31:36,  7.10s/it]

  2%|████▎                                                                                                                                                                                              | 85/3900 [09:28<7:26:13,  7.02s/it]

  2%|████▎                                                                                                                                                                                              | 86/3900 [09:36<7:32:49,  7.12s/it]
{'loss': 0.5101, 'grad_norm': 0.905013382434845, 'learning_rate': 1.4700854700854703e-05, 'epoch': 2.2}


  2%|████▍                                                                                                                                                                                              | 88/3900 [09:50<7:28:50,  7.06s/it]
{'loss': 0.5249, 'grad_norm': 1.0343284606933594, 'learning_rate': 1.5042735042735043e-05, 'epoch': 2.25}


  2%|████▌                                                                                                                                                                                              | 90/3900 [10:04<7:30:16,  7.09s/it]
{'loss': 0.5611, 'grad_norm': 1.0302258729934692, 'learning_rate': 1.5384615384615387e-05, 'epoch': 2.3}


  2%|████▌                                                                                                                                                                                              | 92/3900 [10:18<7:29:30,  7.08s/it]
{'loss': 0.5786, 'grad_norm': 0.9207826852798462, 'learning_rate': 1.5726495726495726e-05, 'epoch': 2.35}


  2%|████▋                                                                                                                                                                                              | 94/3900 [10:32<7:21:17,  6.96s/it]
{'loss': 0.5005, 'grad_norm': 0.9566522836685181, 'learning_rate': 1.6068376068376072e-05, 'epoch': 2.4}


  2%|████▊                                                                                                                                                                                              | 96/3900 [10:46<7:27:24,  7.06s/it]
{'loss': 0.5324, 'grad_norm': 0.9163488745689392, 'learning_rate': 1.641025641025641e-05, 'epoch': 2.45}


  3%|████▉                                                                                                                                                                                              | 98/3900 [11:00<7:29:57,  7.10s/it]
